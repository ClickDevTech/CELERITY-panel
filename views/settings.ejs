<% if (message) { %>
<div class="alert alert-success"><%= message %></div>
<% } %>
<% if (error) { %>
<div class="alert alert-error"><%= error %></div>
<% } %>

<div class="row">
    <div class="col-6">
        <div class="card">
            <div class="card-header">
                <h2>–û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            </div>
            <div class="card-body">
                <div class="settings-list">
                    <div class="setting-item">
                        <label>Base URL</label>
                        <code><%= config.BASE_URL %></code>
                    </div>
                    <div class="setting-item">
                        <label>–ü–æ—Ä—Ç</label>
                        <code><%= config.PORT %></code>
                    </div>
                    <div class="setting-item">
                        <label>MongoDB</label>
                        <code><%= config.MONGO_URI.replace(/\/\/.*@/, '//***@') %></code>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card mt-2">
            <div class="card-header">
                <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–ø–∏—Å–æ–∫</h2>
            </div>
            <div class="card-body">
                <form method="POST" action="/panel/settings">
                    <h4 style="margin-bottom: 0.75rem;">‚öñÔ∏è –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏</h4>
                    <div class="settings-list" style="margin-bottom: 1rem;">
                        <label class="checkbox-label">
                            <input type="checkbox" name="loadBalancing.enabled" 
                                   <%= settings?.loadBalancing?.enabled ? 'checked' : '' %>>
                            <span>–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ</span>
                        </label>
                        <small class="hint" style="display: block; margin-top: 0.25rem;">
                            –ú–µ–Ω–µ–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –Ω–æ–¥—ã –±—É–¥—É—Ç –ø–µ—Ä–≤—ã–º–∏ –≤ –ø–æ–¥–ø–∏—Å–∫–µ
                        </small>
                        
                        <label class="checkbox-label" style="margin-top: 0.75rem;">
                            <input type="checkbox" name="loadBalancing.hideOverloaded" 
                                   <%= settings?.loadBalancing?.hideOverloaded ? 'checked' : '' %>>
                            <span>–°–∫—Ä—ã–≤–∞—Ç—å –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω—ã–µ</span>
                        </label>
                        <small class="hint" style="display: block; margin-top: 0.25rem;">
                            –ù–æ–¥—ã —Å –æ–Ω–ª–∞–π–Ω ‚â• –ª–∏–º–∏—Ç—É –Ω–µ –±—É–¥—É—Ç –≤–∫–ª—é—á–µ–Ω—ã –≤ –ø–æ–¥–ø–∏—Å–∫—É
                        </small>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-6">
        <div class="card">
            <div class="card-header">
                <h2>üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h2>
            </div>
            <div class="card-body">
                <div class="settings-list">
                    <div class="setting-item">
                        <label>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</label>
                        <span><%= admin?.username || 'N/A' %></span>
                    </div>
                    <div class="setting-item">
                        <label>–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥</label>
                        <span><%= admin?.lastLogin ? new Date(admin.lastLogin).toLocaleString('ru-RU') : '–ù–∏–∫–æ–≥–¥–∞' %></span>
                    </div>
                    <div class="setting-item">
                        <label>IP Whitelist</label>
                        <span><%= config.PANEL_IP_WHITELIST || '–û—Ç–∫–ª—é—á–µ–Ω (–¥–æ—Å—Ç—É–ø –≤—Å–µ–º)' %></span>
                    </div>
                </div>
                
                <hr style="margin: 1rem 0; border-color: var(--border);">
                
                <h4 style="margin-bottom: 0.5rem;">–°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è</h4>
                <form method="POST" action="/panel/settings/password" class="compact-form">
                    <div class="form-group">
                        <input type="password" name="currentPassword" placeholder="–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å" required>
                    </div>
                    <div class="form-group">
                        <input type="password" name="newPassword" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å (–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤)" minlength="6" required>
                    </div>
                    <div class="form-group">
                        <input type="password" name="confirmPassword" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è" minlength="6" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-sm">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                </form>
            </div>
        </div>
        
        <div class="card mt-2">
            <div class="card-header">
                <h2>SSL –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</h2>
            </div>
            <div class="card-body">
                <% if (ssl.enabled) { %>
                <div class="alert alert-success">
                    <strong>‚úÖ HTTPS –∞–∫—Ç–∏–≤–µ–Ω</strong>
                    <p>–î–æ–º–µ–Ω: <%= ssl.domain %></p>
                    <p>Let's Encrypt –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</p>
                </div>
                <% } else { %>
                <div class="alert alert-warning">
                    <strong>‚ö†Ô∏è HTTP —Ä–µ–∂–∏–º</strong>
                    <p>–î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è HTTPS –∑–∞–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:</p>
                    <pre>PANEL_DOMAIN=panel.example.com
ACME_EMAIL=admin@example.com</pre>
                </div>
                <% } %>
            </div>
        </div>
        
        <div class="card mt-2">
            <div class="card-header">
                <h2>–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</h2>
            </div>
            <div class="card-body">
                <div class="settings-list">
                    <div class="setting-item">
                        <label>Uptime</label>
                        <span><%= Math.floor(process.uptime() / 3600) %>h <%= Math.floor((process.uptime() % 3600) / 60) %>m</span>
                    </div>
                    <div class="setting-item">
                        <label>Memory</label>
                        <span><%= Math.round(process.memoryUsage().heapUsed / 1024 / 1024) %> MB</span>
                    </div>
                    <div class="setting-item">
                        <label>Node.js</label>
                        <span><%= process.version %></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

